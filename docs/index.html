<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Number Theory Utils: Number Theory Utils (NUT)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_awesome_sidebar.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="/Number-Theory-Utils/index.html">Number Theory Utils</a><span id="projectnumber">&#160;0.2.0</span>
   </div>
  </td>
 </tr>
   <!--BEGIN FULL_SIDEBAR-->
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
   <!--END FULL_SIDEBAR-->
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Number Theory Utils (NUT) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <a href="https://github.com/hacatu/Number-Theory-Utils/actions/workflows/cov_and_docs.yml"><img src="https://github.com/hacatu/Number-Theory-Utils/actions/workflows/cov_and_docs.yml/badge.svg" alt="GitHub CI" style="pointer-events: none;" class="inline"/></a> <a href="https://hacatu.github.io/Number-Theory-Utils/docs"><img src="https://img.shields.io/badge/-documentation-gray" alt="Documentation" class="inline"/></a> <a href="https://hacatu.github.io/Number-Theory-Utils/cov"><img src="https://hacatu.github.io/Number-Theory-Utils/coverage.svg" alt="Coverage" style="pointer-events: none;" class="inline"/></a></p>
<p>A collection of functions for working modular arithmetic, polynomials over finite fields, and related things.</p>
<p>Implements factorization of 64 bit numbers using trial division, Pollard's Rho algorithm with Brent or Floyd cycle finding, and Lenstra's Elliptic Curve algorithm with Wierstrass or Montgomery curves. Planned support for arbitrary precision integers and Kraitcheck style methods (ie quadratic sieve and number field sieve), although Flint and its extension library Arb may be more suited for your needs.</p>
<p>For polynomials, implements finding roots of a polynomial over a prime field using the Cantor-Zassenhaus algorithm.</p>
<p>Also includes general purpose modular arithmetic routines, including powers, Miller-Rabin prime checking, random numbers, random quadratic nonresidues, Jacobi symbols, modular square root including Tonelli-Shanks and Cippola, extended gcd, Chinese remainder theorem, and Euclidean remainder.</p>
<p>For polynomials, also includes arithmetic (addition, subtraction, scalar multiplication, coefficientwise multiplication, multiplication, quotient and remainder, Horner evaluation, gcd, and powers), printing/normalization, and distinct degree factorization. Currently there is a simple driver function that will find all roots of a polynomial over a prime field, but if a full factorization is desired the squarefree step must still be done manually. Like the factorization part of the library, polynomials use 64 bit integers, so computations involving numbers larger than about 2<sup>30</sup> potentially can fail due to overflow.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Building</h1>
<p>This library uses <a href="https://waf.io">Waf</a> as the build system. To build the release variant, simply run <code>./waf configure build_release</code> in the project root directory. The resulting files will be in <code>build/release</code> and <code>build/release/bin</code>, or you can run <code>sudo ./waf install_release</code> after building.</p>
<p>The general usage of Waf is <code>./waf subcommand_1 subcommand_2 ...</code>, where each subcommand is either user defined/modified or builtin, and many subcommands can be specified. Additionally, environment variables can be changed as needed normally by doing <code>CC=clang-13 ./waf ...</code> or similar.</p>
<p>The main subcommands to be aware of are</p><ul>
<li><code>configure</code>: set up Waf, must be run before most other commands</li>
<li><code>build_&lt;variant&gt;</code>: build the indicated variant. Results are stored in <code>build/&lt;variant&gt;</code>. The currently extant variants are:<ul>
<li><code>coverage</code>: debug variant, includes address sanitizer, some ub sanitizers, and coverage collection. builds using <code>gcc</code></li>
<li><code>debug</code>: debug variant, includes memory sanitizer and most ub sanitizers. builds using <code>clang</code></li>
<li><code>release</code>: release variant, no sanitizers. builds using <code>gcc</code> with <code>-O3</code></li>
<li><code>valgrind</code>: debug variant, no sanitizers. builds using <code>clang</code> with <code>-O1</code></li>
<li><code>windows</code>: release variant, no sanitizers. builds using <code>x86_64-w64-mingw32-gcc</code></li>
</ul>
</li>
<li><code>clean_&lt;variant&gt;</code>: delete build files</li>
<li><code>install_&lt;variant&gt;</code>: copy headers, built libraries, and build binaries (but not test binaries) to the system. Typically requires <code>sudo</code>. Consider running without <code>sudo</code> first to ensure it's doing what you want.</li>
<li><code>uninstall_&lt;variant&gt;</code>: remove installed files. Typically requires <code>sudo</code>. Consider running without <code>sudo</code> first to ensure it's doing what you want.</li>
<li><code>test_&lt;variant&gt;</code>: run tests (invoke <code>tests/test.py</code>). This is a special rule, it will always run tests, unlike <code>build_*</code> which only builds outputs if their inputs have changed. Requires <code>build_&lt;variant&gt;</code> to have been run successfully first.<ul>
<li>For the <code>coverage</code> variant, <code>geninfo</code> and <code>genhtml</code> are automatically invoked after tests succeed.</li>
</ul>
</li>
<li><code>distclean</code>: delete the whole build directory (build files for all variants)</li>
<li><code>docs</code>: run <code>doxygen</code> to create the documentation. Similar to <code>test_&lt;variant&gt;</code> this always executes, but it is not tied to a variant.</li>
</ul>
<p>To introduce new variants, look in <code>wscript</code> and add an appropriate section in <code>configure</code> as well as the <code>for</code> loop at the end of the file.</p>
<p>Waf depends on two main files: <code>waf</code>, the compressed python script comprising Waf itself, and <code>wscript</code>, the main user config. These are somewhat analagous to the systemwide <code>make</code> executable and the <code>Makefile</code>. Waf is intended to be distributed with the project, with a separate copy in each project.</p>
<p>Executables, static libraries, and test executables are automatically created based on the contents of <code>src</code>: every C file or directory in <code>src/bin</code> is turned into its own executable in <code>$build/&lt;variant&gt;/bin</code>, every C file or directory in <code>src/lib</code> is turned into its own static library in <code>build/&lt;variant&gt;</code>, and every C file or directory in <code>src/test</code> is turned into its own test executable in <code>build/&lt;variant&gt;</code>.</p>
<p><code>./waf distclean</code> will not remove <code>cov</code> and <code>docs</code>, the directories generated by <code>test_coverage</code> and <code>docs</code> respectively; these can be removed with <code>rm -rf cov docs</code>.</p>
<p>Only Linux is properly supported. To build, only (<code>gcc</code> and <code>ar</code> or <code>clang</code>) and <code>python</code> are strictly required, but <code>lcov</code> and <code>doxygen</code> are required for coverage and documentation, <code>valgrind</code> is required for testing, and it's recommended to have both <code>gcc</code> and <code>clang</code>. Cross compiling for windows requires <code>x86_64-w64-mingw32-gcc</code> and <code>libwinpthread</code> and isn't fully supported. WSL or similar may be better for windows users.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Linking</h1>
<p>Once the library has been built, it can be linked with C programs by adding the flags <code>-Lbuild/release -lnut</code> ( or <code>-Lbuild/&lt;variant&gt; -lnut</code> for a different variant). You can also install it to your system libraries by doing <code>sudo ./waf install_release</code>. This will place the libraries in <code>/usr/local/lib/</code>, the headers in <code>/usr/local/include/nut/</code>, and non-test binaries in <code>/usr/local/bin/</code>. Then the <code>-L</code> flag can be omitted and the library can be linked with simply <code>-lnut</code>. Having the release variant installed systemwide and linking manually against the debug variant if some need arises is probably most convenient.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Examples</h1>
<p>The tests in <code>src/test</code> offer a lot more interesting examples, with basically every function being at least used.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Solve a quadratic equation mod some primes</h2>
<div class="fragment"><div class="line"><span class="keywordflow">for</span>(uint64_t i = 0; i &lt; 100; ++i){</div>
<div class="line">    int64_t p = <a class="code" href="modular__math_8h.html#a0a826b9cca04021df02e1d6405cd2df0">nut_u64_rand</a>(2, 1ull &lt;&lt; 30);</div>
<div class="line">    <span class="keywordflow">while</span>(!<a class="code" href="factorization_8h.html#a48e4f1425cdf116059ee5e0f84348bd5">nut_u64_is_prime_dmr</a>(p)){</div>
<div class="line">        ++p;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Want to solve n**2 - n + 1 == 0 mod p</span></div>
<div class="line">    <span class="comment">//&lt;=&gt; 4*n**2 - 4*n + 4 == 0 mod p</span></div>
<div class="line">    <span class="comment">//&lt;=&gt; (2*n - 1)**2 == -3 mod p</span></div>
<div class="line">    <span class="comment">//&lt;=&gt; n == 2**-1*(1 +- sqrt(-3)) mod p</span></div>
<div class="line">    <span class="keywordflow">switch</span>(<a class="code" href="modular__math_8h.html#a934e38bdacf035d2eef4efc9e35da2d5">nut_i64_jacobi</a>(p - 3, p)){</div>
<div class="line">        <span class="keywordflow">case</span> -1:</div>
<div class="line">            printf(<span class="stringliteral">&quot;n**2 - n + 1 has no roots mod %&quot;</span>PRId64<span class="stringliteral">&quot;\n&quot;</span>, p);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 0:<span class="comment">//-3 is a multiple of p, ie p == 3 so we only have 1 solution</span></div>
<div class="line">            printf(<span class="stringliteral">&quot;n**2 - n + 1 has a root at %&quot;</span>PRId64<span class="stringliteral">&quot; mod %&quot;</span>PRId64<span class="stringliteral">&quot;\n&quot;</span>, (p + 1)/2, p);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>: {</div>
<div class="line">            <span class="comment">//WARNING: here we know p - 3 is a quadratic residue, but nut_i64_sqrt_mod does not check this and thus if a nonresidue is given and</span></div>
<div class="line">            <span class="comment">//Tonelli-Shanks is selected as the optimal algorithm for this p, this would be an infinite loop</span></div>
<div class="line">            int64_t r = <a class="code" href="modular__math_8h.html#a0d036bce1d8fb851b49a4ec0729a5ba1">nut_i64_sqrt_mod</a>(p - 3, p);</div>
<div class="line">            printf(<span class="stringliteral">&quot;n**2 - n + 1 has roots at %&quot;</span>PRId64<span class="stringliteral">&quot; and %&quot;</span>PRId64<span class="stringliteral">&quot; mod %&quot;</span>PRId64<span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="modular__math_8h.html#a4c8177a327f417ecf2c5f1152c0ba8cb">nut_i64_mod</a>((p + 1)/2*(1 + r), p), <a class="code" href="modular__math_8h.html#a4c8177a327f417ecf2c5f1152c0ba8cb">nut_i64_mod</a>((p + 1)/2*(1 - r), p), p);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="afactorization_8h_html_a48e4f1425cdf116059ee5e0f84348bd5"><div class="ttname"><a href="factorization_8h.html#a48e4f1425cdf116059ee5e0f84348bd5">nut_u64_is_prime_dmr</a></div><div class="ttdeci">NUT_ATTR_CONST bool nut_u64_is_prime_dmr(uint64_t n)</div><div class="ttdoc">Check if n is prime using a deterministic Miller-Rabin test.</div></div>
<div class="ttc" id="amodular__math_8h_html_a0a826b9cca04021df02e1d6405cd2df0"><div class="ttname"><a href="modular__math_8h.html#a0a826b9cca04021df02e1d6405cd2df0">nut_u64_rand</a></div><div class="ttdeci">uint64_t nut_u64_rand(uint64_t a, uint64_t b)</div><div class="ttdoc">Generate a (strong) random integer uniformly from [a, b).</div></div>
<div class="ttc" id="amodular__math_8h_html_a0d036bce1d8fb851b49a4ec0729a5ba1"><div class="ttname"><a href="modular__math_8h.html#a0d036bce1d8fb851b49a4ec0729a5ba1">nut_i64_sqrt_mod</a></div><div class="ttdeci">int64_t nut_i64_sqrt_mod(int64_t n, int64_t p)</div><div class="ttdoc">Compute the square root of a quadratic residue mod a prime.</div></div>
<div class="ttc" id="amodular__math_8h_html_a4c8177a327f417ecf2c5f1152c0ba8cb"><div class="ttname"><a href="modular__math_8h.html#a4c8177a327f417ecf2c5f1152c0ba8cb">nut_i64_mod</a></div><div class="ttdeci">int64_t nut_i64_mod(int64_t a, int64_t n)</div><div class="ttdoc">Compute the Euclidean remainder r = a mod n for positive n so that 0 &lt;= r &lt; n.</div></div>
<div class="ttc" id="amodular__math_8h_html_a934e38bdacf035d2eef4efc9e35da2d5"><div class="ttname"><a href="modular__math_8h.html#a934e38bdacf035d2eef4efc9e35da2d5">nut_i64_jacobi</a></div><div class="ttdeci">int64_t nut_i64_jacobi(int64_t n, int64_t k)</div><div class="ttdoc">Compute the Jacobi symbol of n mod k.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md5"></a>
Factor some numbers</h2>
<div class="fragment"><div class="line">factors_t *factors = <a class="code" href="factorization_8h.html#a68ae1e577404fdf655e577a3886dcd3f">nut_make_Factors_w</a>(<a class="code" href="factorization_8h.html#a978817b226b29e568d014886c6d82ee8">NUT_MAX_PRIMES_64</a>);</div>
<div class="line"><span class="keywordflow">for</span>(uint64_t i = 0; i &lt; 100; ++i){</div>
<div class="line">    uint64_t n = <a class="code" href="modular__math_8h.html#a0a826b9cca04021df02e1d6405cd2df0">nut_u64_rand</a>(2, 1ull &lt;&lt; 30);</div>
<div class="line">    <span class="comment">//nut_u64_factor_heuristic will check if the input and intermediate factors are prime</span></div>
<div class="line">    <span class="comment">//it returns the input n divided by all factors found, ie if n is factored completely it returns 1,</span></div>
<div class="line">    <span class="comment">//and it should not return &gt; 1 unless n is greater than all the *_max fields in factor_conf and composite.</span></div>
<div class="line">    <span class="comment">//the primes and num_primes arguments here are null because primes for trial division must be generated by</span></div>
<div class="line">    <span class="comment">//some other function</span></div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code" href="factorization_8h.html#a17d2d8452d2f53bfe6be95d2d8cd21bb">nut_u64_factor_heuristic</a>(n, 0, NULL, &amp;<a class="code" href="factorization_8h.html#a435a05668997a808999bf713833f41dc">nut_default_factor_conf</a>, &amp;factors) != 1){</div>
<div class="line">        printf(<span class="stringliteral">&quot;Failed to factor %&quot;</span>PRIu64<span class="stringliteral">&quot;!\n&quot;</span>, n);</div>
<div class="line">    }<span class="keywordflow">else</span>{</div>
<div class="line">        printf(<span class="stringliteral">&quot;%&quot;</span>PRIu64<span class="stringliteral">&quot; = &quot;</span>, n);</div>
<div class="line">        <a class="code" href="factorization_8h.html#a6c9fc3c6bf989efd453ac7453d8342a1">nut_Factor_fprint</a>(stdout, factors);</div>
<div class="line">        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line">free(factors);</div>
<div class="ttc" id="afactorization_8h_html_a17d2d8452d2f53bfe6be95d2d8cd21bb"><div class="ttname"><a href="factorization_8h.html#a17d2d8452d2f53bfe6be95d2d8cd21bb">nut_u64_factor_heuristic</a></div><div class="ttdeci">NUT_ATTR_NODISCARD uint64_t nut_u64_factor_heuristic(uint64_t n, uint64_t num_primes, const uint64_t primes[restrict static num_primes], const nut_FactorConf *restrict conf, nut_Factors *restrict factors)</div><div class="ttdoc">Factor a number using a variety of approaches based on its size.</div></div>
<div class="ttc" id="afactorization_8h_html_a435a05668997a808999bf713833f41dc"><div class="ttname"><a href="factorization_8h.html#a435a05668997a808999bf713833f41dc">nut_default_factor_conf</a></div><div class="ttdeci">const nut_FactorConf nut_default_factor_conf</div><div class="ttdoc">Default value for nut_u64_factor_heuristic Use if you don't want to tune the parameters or don't care...</div></div>
<div class="ttc" id="afactorization_8h_html_a68ae1e577404fdf655e577a3886dcd3f"><div class="ttname"><a href="factorization_8h.html#a68ae1e577404fdf655e577a3886dcd3f">nut_make_Factors_w</a></div><div class="ttdeci">NUT_ATTR_MALLOC nut_Factors * nut_make_Factors_w(uint64_t max_primes)</div><div class="ttdoc">Allocate a factors structure that can hold a given number of distinct primes.</div></div>
<div class="ttc" id="afactorization_8h_html_a6c9fc3c6bf989efd453ac7453d8342a1"><div class="ttname"><a href="factorization_8h.html#a6c9fc3c6bf989efd453ac7453d8342a1">nut_Factor_fprint</a></div><div class="ttdeci">int nut_Factor_fprint(FILE *restrict file, const nut_Factors *restrict factors)</div><div class="ttdoc">Print a factorization of a number.</div></div>
<div class="ttc" id="afactorization_8h_html_a978817b226b29e568d014886c6d82ee8"><div class="ttname"><a href="factorization_8h.html#a978817b226b29e568d014886c6d82ee8">NUT_MAX_PRIMES_64</a></div><div class="ttdeci">#define NUT_MAX_PRIMES_64</div><div class="ttdoc">The most distinct prime divisors a uint64_t can have.</div><div class="ttdef"><b>Definition:</b> <a href="factorization_8h_source.html#l00023">factorization.h:23</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
Factor a polynomial mod some primes</h2>
<div class="fragment"><div class="line"><a class="code" href="structnut__Poly.html">nut_Poly</a> f[1];</div>
<div class="line"><a class="code" href="polynomial_8h.html#ad6a9d3a96f876ec4d7e63a16a7437ec5">nut_Poly_init</a>(f, 9);</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *end = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">int64_t modulus;</div>
<div class="line"><span class="keywordflow">if</span>(!<a class="code" href="polynomial_8h.html#a769b94e1c6b23b4fa4af0452a7d26eef">nut_Poly_parse</a>(f, &amp;modulus, <span class="stringliteral">&quot;x^8 + x^7 - x^5 - x^4 - x^3 + x + 1&quot;</span>, &amp;end) || *end){</div>
<div class="line">    printf(<span class="stringliteral">&quot;Failed to parse polynomial\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">fprintf(stderr, <span class="stringliteral">&quot;\e[1;34mComputing roots of (&quot;</span>);</div>
<div class="line"><a class="code" href="polynomial_8h.html#af487a60a5381651e58b69252125b7b56">nut_Poly_fprint</a>(stderr, f, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot; + &quot;</span>, <span class="stringliteral">&quot; - &quot;</span>, <span class="stringliteral">&quot;**&quot;</span>, 1);</div>
<div class="line">fprintf(stderr, <span class="stringliteral">&quot;) nut_i64_mod p for %&quot;</span>PRIu64<span class="stringliteral">&quot; random primes...\e[0m\n&quot;</span>, trials);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="structnut__Roots.html">nut_Roots</a> roots[1];</div>
<div class="line"><a class="code" href="polynomial_8h.html#ac64995d45deb2bc583b4d70cbce1d5c2">nut_Roots_init</a>(roots, 8);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span>(uint64_t i = 0; i &lt; 50; ++i){</div>
<div class="line">    int64_t p = <a class="code" href="modular__math_8h.html#a0a826b9cca04021df02e1d6405cd2df0">nut_u64_rand</a>(2, 1ull &lt;&lt; 30);</div>
<div class="line">    <span class="keywordflow">while</span>(!<a class="code" href="factorization_8h.html#a48e4f1425cdf116059ee5e0f84348bd5">nut_u64_is_prime_dmr</a>(p)){</div>
<div class="line">        ++p;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>(!<a class="code" href="polynomial_8h.html#a1ff32591f043cb44bcabba3996a2c619">nut_Poly_roots_modn_tmptmp</a>(f, p, roots)){</div>
<div class="line">        printf(<span class="stringliteral">&quot;Failed to factor (&quot;</span>);</div>
<div class="line">        <a class="code" href="polynomial_8h.html#af487a60a5381651e58b69252125b7b56">nut_Poly_fprint</a>(stdout, f, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot; + &quot;</span>, <span class="stringliteral">&quot; - &quot;</span>, <span class="stringliteral">&quot;**&quot;</span>, 1);</div>
<div class="line">        printf(<span class="stringliteral">&quot;) nut_i64_mod %&quot;</span>PRId64<span class="stringliteral">&quot;\n&quot;</span>, p)</div>
<div class="line">        <span class="keywordflow">continue</span>;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Found %&quot;</span>PRIu64<span class="stringliteral">&quot; roots of (&quot;</span>, roots-&gt;<a class="code" href="structnut__Roots.html#a52b50bc7b374bb528cdae1b4477b69c1">len</a>);</div>
<div class="line">    <a class="code" href="polynomial_8h.html#af487a60a5381651e58b69252125b7b56">nut_Poly_fprint</a>(stdout, f, <span class="stringliteral">&quot;x&quot;</span>, <span class="stringliteral">&quot; + &quot;</span>, <span class="stringliteral">&quot; - &quot;</span>, <span class="stringliteral">&quot;**&quot;</span>, 1);</div>
<div class="line">    printf(<span class="stringliteral">&quot;) nut_i64_mod %&quot;</span>PRId64, p);</div>
<div class="line">    <span class="keywordflow">if</span>(roots-&gt;<a class="code" href="structnut__Roots.html#a52b50bc7b374bb528cdae1b4477b69c1">len</a>){</div>
<div class="line">        printf(<span class="stringliteral">&quot;: &quot;</span>);</div>
<div class="line">    }<span class="keywordflow">else</span>{</div>
<div class="line">        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span>(uint64_t i = 0; i &lt; roots-&gt;<a class="code" href="structnut__Roots.html#a52b50bc7b374bb528cdae1b4477b69c1">len</a>; ++i){</div>
<div class="line">        printf();</div>
<div class="line">        <span class="keywordflow">if</span>(i != roots-&gt;<a class="code" href="structnut__Roots.html#a52b50bc7b374bb528cdae1b4477b69c1">len</a> - 1){</div>
<div class="line">            printf(<span class="stringliteral">&quot;%&quot;</span>PRId64<span class="stringliteral">&quot;, &quot;</span>, roots-&gt;<a class="code" href="structnut__Roots.html#a4938a9a6f1cb009c71930447a417b467">roots</a>[i]);</div>
<div class="line">        }<span class="keywordflow">else</span>{</div>
<div class="line">            printf(<span class="stringliteral">&quot;and %&quot;</span>PRId64<span class="stringliteral">&quot;\n&quot;</span>, roots-&gt;<a class="code" href="structnut__Roots.html#a4938a9a6f1cb009c71930447a417b467">roots</a>[i]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><a class="code" href="polynomial_8h.html#acfa2292bfc27186033c1c65930250f55">nut_Roots_destroy</a>(roots);</div>
<div class="line"><a class="code" href="polynomial_8h.html#adf706197f57e4ffc4496a4209d997985">nut_Poly_destroy</a>(f);</div>
<div class="ttc" id="apolynomial_8h_html_a1ff32591f043cb44bcabba3996a2c619"><div class="ttname"><a href="polynomial_8h.html#a1ff32591f043cb44bcabba3996a2c619">nut_Poly_roots_modn_tmptmp</a></div><div class="ttdeci">bool nut_Poly_roots_modn_tmptmp(const nut_Poly *restrict f, int64_t n, nut_Roots *restrict roots)</div><div class="ttdoc">Find all roots of a polynomial in an odd prime field.</div></div>
<div class="ttc" id="apolynomial_8h_html_a769b94e1c6b23b4fa4af0452a7d26eef"><div class="ttname"><a href="polynomial_8h.html#a769b94e1c6b23b4fa4af0452a7d26eef">nut_Poly_parse</a></div><div class="ttdeci">int nut_Poly_parse(nut_Poly *restrict f, int64_t *restrict n, const char *restrict str, const char *restrict *restrict end)</div><div class="ttdoc">Convert a string to a polynomial (and possibly modulus)</div></div>
<div class="ttc" id="apolynomial_8h_html_ac64995d45deb2bc583b4d70cbce1d5c2"><div class="ttname"><a href="polynomial_8h.html#ac64995d45deb2bc583b4d70cbce1d5c2">nut_Roots_init</a></div><div class="ttdeci">NUT_ATTR_NODISCARD bool nut_Roots_init(nut_Roots *roots, uint64_t reserve)</div><div class="ttdoc">Initialize a root buffer with at least a given capacity.</div></div>
<div class="ttc" id="apolynomial_8h_html_acfa2292bfc27186033c1c65930250f55"><div class="ttname"><a href="polynomial_8h.html#acfa2292bfc27186033c1c65930250f55">nut_Roots_destroy</a></div><div class="ttdeci">void nut_Roots_destroy(nut_Roots *roots)</div><div class="ttdoc">Free resources held by a root buffer.</div></div>
<div class="ttc" id="apolynomial_8h_html_ad6a9d3a96f876ec4d7e63a16a7437ec5"><div class="ttname"><a href="polynomial_8h.html#ad6a9d3a96f876ec4d7e63a16a7437ec5">nut_Poly_init</a></div><div class="ttdeci">NUT_ATTR_NODISCARD bool nut_Poly_init(nut_Poly *f, uint64_t reserve)</div><div class="ttdoc">Initialize a polynomial with at least a given capacity.</div></div>
<div class="ttc" id="apolynomial_8h_html_adf706197f57e4ffc4496a4209d997985"><div class="ttname"><a href="polynomial_8h.html#adf706197f57e4ffc4496a4209d997985">nut_Poly_destroy</a></div><div class="ttdeci">void nut_Poly_destroy(nut_Poly *f)</div><div class="ttdoc">Free resources held by a polynomial struct.</div></div>
<div class="ttc" id="apolynomial_8h_html_af487a60a5381651e58b69252125b7b56"><div class="ttname"><a href="polynomial_8h.html#af487a60a5381651e58b69252125b7b56">nut_Poly_fprint</a></div><div class="ttdeci">int nut_Poly_fprint(FILE *restrict file, const nut_Poly *restrict f, const char *vname, const char *add, const char *sub, const char *pow, bool descending)</div><div class="ttdoc">Print a polynomial to a file.</div></div>
<div class="ttc" id="astructnut__Poly_html"><div class="ttname"><a href="structnut__Poly.html">nut_Poly</a></div><div class="ttdoc">A polynomial with signed integer coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="polynomial_8h_source.html#l00026">polynomial.h:26</a></div></div>
<div class="ttc" id="astructnut__Roots_html"><div class="ttname"><a href="structnut__Roots.html">nut_Roots</a></div><div class="ttdoc">The roots of a polynomial over a finite field, ignoring multiplicity.</div><div class="ttdef"><b>Definition:</b> <a href="polynomial_8h_source.html#l00038">polynomial.h:38</a></div></div>
<div class="ttc" id="astructnut__Roots_html_a4938a9a6f1cb009c71930447a417b467"><div class="ttname"><a href="structnut__Roots.html#a4938a9a6f1cb009c71930447a417b467">nut_Roots::roots</a></div><div class="ttdeci">int64_t * roots</div><div class="ttdoc">Array of roots.</div><div class="ttdef"><b>Definition:</b> <a href="polynomial_8h_source.html#l00045">polynomial.h:45</a></div></div>
<div class="ttc" id="astructnut__Roots_html_a52b50bc7b374bb528cdae1b4477b69c1"><div class="ttname"><a href="structnut__Roots.html#a52b50bc7b374bb528cdae1b4477b69c1">nut_Roots::len</a></div><div class="ttdeci">uint64_t len</div><div class="ttdoc">Number of roots, can be 0 if there are none.</div><div class="ttdef"><b>Definition:</b> <a href="polynomial_8h_source.html#l00040">polynomial.h:40</a></div></div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Nov 19 2024 00:29:41 for Number Theory Utils by <a href="https://www.doxygen.org/index.html">Doxygen</a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
